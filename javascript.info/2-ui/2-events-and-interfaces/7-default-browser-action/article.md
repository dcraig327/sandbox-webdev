# Действия браузера по умолчанию

Многие события влекут за собой действие браузера.

Например:
<ul>
<li>Клик по ссылке инициирует переход на новый URL</li>
<li>Нажатие на кнопку "отправить" в форме -- посылку ее на сервер</li>
<li>Двойной клик на тексте -- инициирует его выделение.</li>
</ul>

**Зачастую, мы полностью обрабатываем событие в JavaScript, и такое действие браузера нам не нужно.**

К счастью, его можно отменить.

[cut]
## Отмена действия браузера

Есть два способа отменить действие браузера:
<ul>
<li>**Основной способ -- это воспользоваться объектом события. Для отмены действия браузера существует стандартный метод `event.preventDefault()`.**</li>
<li>Если же обработчик назначен через `on...` (не через `addEventListener/attachEvent`), то можно просто вернуть `false` из обработчика.</li>
</ul>

В следующем примере при клике по ссылке переход не произойдет:

```html
<!--+ autorun -->
<a href="/" onclick="return false">Нажми здесь</a>
или
<a href="/" onclick="event.preventDefault()">здесь</a>
```

[warn header="Возвращать `true` не нужно"]
Вообще говоря, значение, которое возвращает обработчик, игнорируется.

Единственное исключение -- это `return false` из обработчика, назначенного через `onсобытие`. 

Иногда в коде начинающих разработчиков можно увидеть `return` других значений. Но они не нужны и никак не обрабатываются. 
[/warn]

### Пример: меню

Рассмотрим задачу, когда нужно создать меню для сайта, например такое:

```html
<ul id="menu" class="menu">
  <li><a href="/php">PHP</a></li>
  <li><a href="/html">HTML</a></li>
  <li><a href="/javascript">JavaScript</a></li>
  <li><a href="/flash">Flash</a></li>
</ul>
```

Данный пример при помощи CSS может выводиться так:

[iframe height=70 src="menu" link edit]

**Все элементы меню являются ссылками, то есть тегами `<a>`.**

Это потому, что некоторые посетители очень любят сочетание "правый клик - открыть в новом окне".  Да, мы можем использовать и `<button>` и `<span>`, но если правый клик не работает -- это их огорчает. Кроме того, если на сайт зайдёт поисковик, то по ссылке из `<a href="...">` он перейдёт, а выполнить сложный JavaScript и получить результат -- вряд ли захочет.

**Значение `<a href="...">` -- это "запасной вариант", для правого клика и для поисковиков, а обычно клик будет обрабатываться JavaScript.**

Например, вот так:

```js
menu.onclick = function(event) {
  if (event.target.nodeName != 'A') return;

  var href = event.target.getAttribute('href');
  alert(href); // может быть подгрузка с сервера, генерация интерфейса и т.п.

*!*
  return false; // отменить переход по url
*/!*
};
```

В конце `return false`, иначе браузер перейдёт по адресу из `href`.

Так как мы применили делегирование, то меню может увеличиваться, можно добавить вложенные списки `ul/li`, стилизовать их при помощи CSS -- меню продолжит работать.

## Другие действия браузера

Действий браузера по умолчанию достаточно много. 

Вот некоторые примеры событий, которые вызывают действие браузера:
<ul>
<li>`mousedown` -- нажатие кнопкой мыши в то время как курсор находится на тексте начинает его выделение.</li>
<li>`click` на `<input type="checkbox">` -- ставит или убирает галочку.</li>
<li>`submit` -- при нажатии на `<input type="submit">`  в форме данные отправляются на сервер.</li>
<li>`wheel` -- движение колёсика мыши инициирует прокрутку.</li>
<li>`keydown` -- при нажатии клавиши в поле ввода появляется символ.</li>
<li>`contextmenu` -- при правом клике показывается контекстное меню браузера.</li>
<li>...</li>
</ul>

Все эти действия можно отменить, если мы хотим обработать событие исключительно при помощи JavaScript.

[warn header="События могут быть связаны между собой"]
Некоторые события естественным образом вытекают друг из друга.

Например, нажатие мышкой `mousedown` на поле ввода `<input>` приводит к фокусировке внутрь него. Если отменить действие `mousedown`, то и фокуса не будет.

Попробуйте нажать мышкой на первый `<input>` -- произойдёт событие `onfocus`. Это обычная ситуация.

Но если нажать на второй, то фокусировки не произойдёт.

```html
<!--+ run autorun -->
<input value="Фокус работает" onfocus="this.value=''">
<input *!*onmousedown="return false"*/!* onfocus="this.value=''" value="Кликни меня">
```

...С другой стороны, во второй `<input>` можно перейти с первого нажатием клавиши [key Tab], и тогда фокусировка сработает. То есть, дело здесь именно в `onmousedown="return false"`.
[/warn]

## Особенности IE8-

В IE8- для отмены действия по умолчанию нужно назначить свойство `event.returnValue = false`.

Кроссбраузерный код для отмены действия по умолчанию:

```js
element.onclick = function(event) {
  event = event || window.event;

  if (event.preventDefault) {  // если метод существует
    event.preventDefault(); // то вызвать его
  } else { // иначе вариант IE<9:
    event.returnValue = false;
  }
}
```

Можно записать в одну строку:

```js
...
event.preventDefault ? event.preventDefault() : (event.returnValue=false);
...
```

## Итого

<ul>
<li>Браузер имеет встроенные действия при ряде событий -- переход по ссылке, отправка формы и т.п. Как правило, их можно отменить.</li>
<li>Есть два способа отменить действие по умолчанию: первый -- использовать `event.preventDefault()` (IE<9: `event.returnValue=false`), второй -- `return false` из обработчика. Второй способ работает только если обработчик назначен через `onсобытие`.</li>
</ul>


